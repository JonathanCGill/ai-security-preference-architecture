<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="700" viewBox="0 0 1100 700" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <filter id="shadow" x="-2%" y="-2%" width="104%" height="104%">
      <feDropShadow dx="1" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.2"/>
    </filter>
    <marker id="arrowFlow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#4ecca3" opacity="0.8"/>
    </marker>
    <marker id="arrowRed" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#e94560" opacity="0.8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1100" height="700" rx="8" fill="#0d1117"/>

  <!-- Title -->
  <text x="550" y="38" text-anchor="middle" fill="#e6e6e6" font-size="22" font-weight="700">Agent Identity Lifecycle — Governance Model</text>
  <text x="550" y="60" text-anchor="middle" fill="#8b949e" font-size="13">Every agent identity passes through six governed phases — no exceptions, no shortcuts</text>

  <!-- Phase 1: Provisioning -->
  <rect x="60" y="90" width="300" height="150" rx="6" fill="#1a1a2e" stroke="#533483" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="80" y="115" fill="#c084fc" font-size="14" font-weight="700">1. PROVISIONING</text>
  <text x="80" y="135" fill="#e6e6e6" font-size="11">Unique identity created in IdP</text>
  <text x="80" y="152" fill="#e6e6e6" font-size="11">Risk tier classification assigned</text>
  <text x="80" y="169" fill="#e6e6e6" font-size="11">Human sponsor designated</text>
  <text x="80" y="186" fill="#e6e6e6" font-size="11">Initial permissions scoped to task</text>
  <text x="80" y="203" fill="#8b949e" font-size="10">ISO 27001 A.5.16 · OWASP NHI5</text>
  <text x="80" y="220" fill="#e94560" font-size="10" font-weight="600">No shared credentials. No inherited roles.</text>

  <!-- Arrow 1→2 -->
  <line x1="360" y1="165" x2="400" y2="165" stroke="#4ecca3" stroke-width="1.5" marker-end="url(#arrowFlow)"/>

  <!-- Phase 2: Authentication -->
  <rect x="410" y="90" width="300" height="150" rx="6" fill="#1a1a2e" stroke="#533483" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="430" y="115" fill="#c084fc" font-size="14" font-weight="700">2. AUTHENTICATION</text>
  <text x="430" y="135" fill="#e6e6e6" font-size="11">mTLS or OAuth 2.0 client credentials</text>
  <text x="430" y="152" fill="#e6e6e6" font-size="11">Short-lived tokens (minutes, not days)</text>
  <text x="430" y="169" fill="#e6e6e6" font-size="11">Proof-of-possession (DPoP) binding</text>
  <text x="430" y="186" fill="#e6e6e6" font-size="11">Workload identity (SPIFFE/SVID)</text>
  <text x="430" y="203" fill="#8b949e" font-size="10">NIST SP 800-207 · Zero Trust</text>
  <text x="430" y="220" fill="#e94560" font-size="10" font-weight="600">No long-lived secrets. No static API keys.</text>

  <!-- Arrow 2→3 -->
  <line x1="710" y1="165" x2="750" y2="165" stroke="#4ecca3" stroke-width="1.5" marker-end="url(#arrowFlow)"/>

  <!-- Phase 3: Authorisation -->
  <rect x="760" y="90" width="300" height="150" rx="6" fill="#1a1a2e" stroke="#533483" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="780" y="115" fill="#c084fc" font-size="14" font-weight="700">3. AUTHORISATION</text>
  <text x="780" y="135" fill="#e6e6e6" font-size="11">Least privilege per task</text>
  <text x="780" y="152" fill="#e6e6e6" font-size="11">Context-aware dynamic policy</text>
  <text x="780" y="169" fill="#e6e6e6" font-size="11">Delegation narrows — never expands</text>
  <text x="780" y="186" fill="#e6e6e6" font-size="11">Tool allowlists enforced at gateway</text>
  <text x="780" y="203" fill="#8b949e" font-size="10">IAM-02 · IAM-04 · TOOL-01</text>
  <text x="780" y="220" fill="#e94560" font-size="10" font-weight="600">No standing privileges. JIT only.</text>

  <!-- Arrow 3→4 -->
  <line x1="910" y1="240" x2="910" y2="280" stroke="#4ecca3" stroke-width="1.5" marker-end="url(#arrowFlow)"/>

  <!-- Phase 4: Monitoring -->
  <rect x="760" y="290" width="300" height="150" rx="6" fill="#0f3460" stroke="#1a6f9a" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="780" y="315" fill="#4ecca3" font-size="14" font-weight="700">4. MONITORING</text>
  <text x="780" y="335" fill="#e6e6e6" font-size="11">All actions logged (tamper-proof)</text>
  <text x="780" y="352" fill="#e6e6e6" font-size="11">Behavioural baseline comparison</text>
  <text x="780" y="369" fill="#e6e6e6" font-size="11">Permission usage tracking</text>
  <text x="780" y="386" fill="#e6e6e6" font-size="11">Anomaly detection via Judge</text>
  <text x="780" y="403" fill="#8b949e" font-size="10">IAM-08 · LOG-01 · OWASP ASI10</text>
  <text x="780" y="420" fill="#e94560" font-size="10" font-weight="600">Alert on deviation. Revoke on anomaly.</text>

  <!-- Arrow 4→5 -->
  <line x1="760" y1="365" x2="710" y2="365" stroke="#4ecca3" stroke-width="1.5" marker-end="url(#arrowFlow)"/>

  <!-- Phase 5: Review -->
  <rect x="410" y="290" width="300" height="150" rx="6" fill="#0f3460" stroke="#1a6f9a" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="430" y="315" fill="#4ecca3" font-size="14" font-weight="700">5. ACCESS REVIEW</text>
  <text x="430" y="335" fill="#e6e6e6" font-size="11">Quarterly permission review</text>
  <text x="430" y="352" fill="#e6e6e6" font-size="11">Sponsor re-confirms necessity</text>
  <text x="430" y="369" fill="#e6e6e6" font-size="11">Unused permissions removed</text>
  <text x="430" y="386" fill="#e6e6e6" font-size="11">Credential audit and rotation</text>
  <text x="430" y="403" fill="#8b949e" font-size="10">ISO 27001 A.5.18 · OWASP NHI1</text>
  <text x="430" y="420" fill="#e94560" font-size="10" font-weight="600">Fail-closed: no review = no renewal.</text>

  <!-- Arrow 5→6 -->
  <line x1="410" y1="365" x2="360" y2="365" stroke="#4ecca3" stroke-width="1.5" marker-end="url(#arrowFlow)"/>

  <!-- Phase 6: Deprovisioning -->
  <rect x="60" y="290" width="300" height="150" rx="6" fill="#0f3460" stroke="#1a6f9a" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="80" y="315" fill="#4ecca3" font-size="14" font-weight="700">6. DEPROVISIONING</text>
  <text x="80" y="335" fill="#e6e6e6" font-size="11">Triggered by: task completion, incident,</text>
  <text x="80" y="352" fill="#e6e6e6" font-size="11">sponsor departure, risk reclassification</text>
  <text x="80" y="369" fill="#e6e6e6" font-size="11">All credentials revoked within minutes</text>
  <text x="80" y="386" fill="#e6e6e6" font-size="11">Audit logs archived (immutable)</text>
  <text x="80" y="403" fill="#8b949e" font-size="10">IAM-06 · OWASP NHI1 · NHI7</text>
  <text x="80" y="420" fill="#e94560" font-size="10" font-weight="600">No orphaned identities. Ever.</text>

  <!-- Emergency revocation arrow -->
  <rect x="60" y="470" width="1000" height="65" rx="6" fill="#3a1a1a" stroke="#e94560" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="80" y="495" fill="#e94560" font-size="14" font-weight="700">EMERGENCY REVOCATION</text>
  <text x="320" y="495" fill="#e6e6e6" font-size="12">Anomaly detected — immediate credential revocation across all systems</text>
  <text x="80" y="518" fill="#8b949e" font-size="11">Latency target: 30 seconds (Tier 3) · 5 minutes (Tier 2) · 1 hour (Tier 1) — automated, not manual</text>

  <!-- Three-layer connection -->
  <rect x="60" y="555" width="320" height="55" rx="5" fill="#1e1e3f" stroke="#f0a500" stroke-width="1"/>
  <text x="220" y="578" text-anchor="middle" fill="#f0a500" font-size="12" font-weight="600">Guardrails</text>
  <text x="220" y="597" text-anchor="middle" fill="#8b949e" font-size="10">Enforce identity at every boundary</text>

  <rect x="400" y="555" width="320" height="55" rx="5" fill="#1e1e3f" stroke="#c084fc" stroke-width="1"/>
  <text x="560" y="578" text-anchor="middle" fill="#c084fc" font-size="12" font-weight="600">Judge</text>
  <text x="560" y="597" text-anchor="middle" fill="#8b949e" font-size="10">Detect anomalous access patterns</text>

  <rect x="740" y="555" width="320" height="55" rx="5" fill="#1e1e3f" stroke="#4ecca3" stroke-width="1"/>
  <text x="900" y="578" text-anchor="middle" fill="#4ecca3" font-size="12" font-weight="600">Human Oversight</text>
  <text x="900" y="597" text-anchor="middle" fill="#8b949e" font-size="10">Approve, review, and sponsor identities</text>

  <!-- Standards bar -->
  <text x="550" y="645" text-anchor="middle" fill="#8b949e" font-size="10">Standards: NIST SP 800-207 (Zero Trust) · ISO 27001:2022 A.5.15-A.5.17 · ISO 42001:2023 · OWASP NHI Top 10 · OWASP Agentic Top 10 · SPIFFE/SVID</text>

  <!-- Footer -->
  <text x="550" y="680" text-anchor="middle" fill="#484f58" font-size="10">AI Runtime Behaviour Security — IAM Governance · Agent Identity Lifecycle · github.com/JonathanCGill</text>
</svg>
