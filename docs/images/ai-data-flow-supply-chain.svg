<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="550" viewBox="0 0 1000 550">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569"/>
    </marker>
    <marker id="arrow-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="550" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="500" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1e293b" text-anchor="middle">AI Data Flow Supply Chain</text>
  <text x="500" y="50" font-family="Arial, sans-serif" font-size="11" fill="#64748b" text-anchor="middle">Every component is an attack surface. Every connection can be manipulated.</text>
  
  <!-- Section labels -->
  <rect x="50" y="75" width="200" height="25" rx="4" fill="#dbeafe"/>
  <text x="150" y="92" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1e40af" text-anchor="middle">UPSTREAM</text>
  
  <rect x="400" y="75" width="200" height="25" rx="4" fill="#dcfce7"/>
  <text x="500" y="92" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#166534" text-anchor="middle">AI CORE</text>
  
  <rect x="750" y="75" width="200" height="25" rx="4" fill="#fef3c7"/>
  <text x="850" y="92" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#b45309" text-anchor="middle">DOWNSTREAM</text>
  
  <!-- Upstream components -->
  <rect x="50" y="120" width="140" height="50" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="120" y="145" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">User Input</text>
  <text x="120" y="160" font-family="Arial, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">Queries, uploads, actions</text>
  
  <rect x="50" y="185" width="140" height="50" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="120" y="210" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">Databases</text>
  <text x="120" y="225" font-family="Arial, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">Customer, product, config</text>
  
  <rect x="50" y="250" width="140" height="50" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="120" y="275" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">External APIs</text>
  <text x="120" y="290" font-family="Arial, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">Third-party services</text>
  
  <rect x="50" y="315" width="140" height="50" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="120" y="340" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">Documents</text>
  <text x="120" y="355" font-family="Arial, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">RAG, context, uploads</text>
  
  <rect x="50" y="380" width="140" height="50" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="120" y="405" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">Context/Memory</text>
  <text x="120" y="420" font-family="Arial, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">Conversation, state</text>
  
  <!-- AI Core components -->
  <rect x="280" y="140" width="100" height="45" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="330" y="163" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#166534" text-anchor="middle">Input</text>
  <text x="330" y="176" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#166534" text-anchor="middle">Guardrails</text>
  
  <rect x="430" y="200" width="140" height="70" rx="8" fill="#bbf7d0" stroke="#22c55e" stroke-width="3"/>
  <text x="500" y="230" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#166534" text-anchor="middle">AI Model</text>
  <text x="500" y="250" font-family="Arial, sans-serif" font-size="10" fill="#166534" text-anchor="middle">+ Prompts + Tools</text>
  
  <rect x="620" y="140" width="100" height="45" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="670" y="163" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#166534" text-anchor="middle">Output</text>
  <text x="670" y="176" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#166534" text-anchor="middle">Guardrails</text>
  
  <rect x="430" y="320" width="140" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="500" y="345" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#b45309" text-anchor="middle">Judge</text>
  <text x="500" y="360" font-family="Arial, sans-serif" font-size="9" fill="#92400e" text-anchor="middle">(Async evaluation)</text>
  
  <rect x="430" y="400" width="140" height="50" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="2"/>
  <text x="500" y="425" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#475569" text-anchor="middle">Logging</text>
  <text x="500" y="440" font-family="Arial, sans-serif" font-size="9" fill="#64748b" text-anchor="middle">Full audit trail</text>
  
  <!-- Downstream components -->
  <rect x="810" y="120" width="140" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="880" y="145" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#b45309" text-anchor="middle">User Response</text>
  <text x="880" y="160" font-family="Arial, sans-serif" font-size="9" fill="#92400e" text-anchor="middle">Chat, recommendations</text>
  
  <rect x="810" y="185" width="140" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="880" y="210" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#b45309" text-anchor="middle">Database Writes</text>
  <text x="880" y="225" font-family="Arial, sans-serif" font-size="9" fill="#92400e" text-anchor="middle">Records, updates</text>
  
  <rect x="810" y="250" width="140" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="880" y="275" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#b45309" text-anchor="middle">API Calls</text>
  <text x="880" y="290" font-family="Arial, sans-serif" font-size="9" fill="#92400e" text-anchor="middle">Trigger actions</text>
  
  <rect x="810" y="315" width="140" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="880" y="340" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#b45309" text-anchor="middle">Workflows</text>
  <text x="880" y="355" font-family="Arial, sans-serif" font-size="9" fill="#92400e" text-anchor="middle">Approvals, escalations</text>
  
  <rect x="810" y="380" width="140" height="50" rx="6" fill="#fce7f3" stroke="#ec4899" stroke-width="2"/>
  <text x="880" y="405" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#be185d" text-anchor="middle">Human Review</text>
  <text x="880" y="420" font-family="Arial, sans-serif" font-size="9" fill="#9d174d" text-anchor="middle">Decisions, actions</text>
  
  <!-- Arrows: Upstream to AI Core -->
  <line x1="190" y1="145" x2="275" y2="162" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="190" y1="210" x2="275" y2="162" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="190" y1="275" x2="425" y2="235" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="190" y1="340" x2="425" y2="235" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="190" y1="405" x2="425" y2="235" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Arrows: Within AI Core -->
  <line x1="380" y1="162" x2="425" y2="220" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="575" y1="235" x2="615" y2="162" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="500" y1="270" x2="500" y2="315" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="500" y1="370" x2="500" y2="395" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Arrows: AI Core to Downstream -->
  <line x1="720" y1="162" x2="805" y2="145" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="575" y1="250" x2="805" y2="210" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="575" y1="250" x2="805" y2="275" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="575" y1="250" x2="805" y2="340" stroke="#475569" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Judge to Human -->
  <line x1="575" y1="345" x2="805" y2="405" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Attack surface indicators -->
  <circle cx="205" cy="145" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="205" y="149" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="205" cy="210" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="205" y="214" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="205" cy="340" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="205" y="344" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="397" cy="162" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="397" y="166" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="595" cy="200" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="595" y="204" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="790" cy="210" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="790" y="214" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <circle cx="790" cy="340" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="790" y="344" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  
  <!-- Legend -->
  <rect x="50" y="470" width="900" height="60" rx="6" fill="#ffffff" stroke="#e2e8f0" stroke-width="1"/>
  
  <rect x="70" y="485" width="16" height="16" rx="3" fill="#e0e7ff" stroke="#6366f1" stroke-width="1"/>
  <text x="95" y="497" font-family="Arial, sans-serif" font-size="10" fill="#475569">Upstream (data sources)</text>
  
  <rect x="250" y="485" width="16" height="16" rx="3" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="275" y="497" font-family="Arial, sans-serif" font-size="10" fill="#475569">AI Core (model + controls)</text>
  
  <rect x="450" y="485" width="16" height="16" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <text x="475" y="497" font-family="Arial, sans-serif" font-size="10" fill="#475569">Downstream (outputs + actions)</text>
  
  <rect x="670" y="485" width="16" height="16" rx="3" fill="#fce7f3" stroke="#ec4899" stroke-width="1"/>
  <text x="695" y="497" font-family="Arial, sans-serif" font-size="10" fill="#475569">Human oversight</text>
  
  <circle cx="855" cy="493" r="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="855" y="497" font-family="Arial, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">!</text>
  <text x="875" y="497" font-family="Arial, sans-serif" font-size="10" fill="#475569">Attack surface</text>
  
  <text x="500" y="520" font-family="Arial, sans-serif" font-size="10" fill="#64748b" text-anchor="middle">Threats anywhere in this chain can compromise the AI system. Include all components in threat analysis.</text>
</svg>
