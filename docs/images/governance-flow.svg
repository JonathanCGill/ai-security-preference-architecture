<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="1520" viewBox="0 0 1100 1520" font-family="'Segoe UI', Arial, Helvetica, sans-serif">

  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#334155"/>
    </marker>
    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#dc2626"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#16a34a"/>
    </marker>
    <marker id="arrow-amber" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#d97706"/>
    </marker>
    <marker id="arrow-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#2563eb"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1100" height="1520" fill="#ffffff"/>

  <!-- Title -->
  <text x="550" y="40" text-anchor="middle" font-size="22" font-weight="700" fill="#0f172a">Intent Declaration and Guardrail Governance</text>
  <text x="550" y="62" text-anchor="middle" font-size="13" fill="#64748b">Declare â†’ Derive â†’ Enforce â†’ Investigate â†’ Charge</text>

  <!-- ==================== PHASE 1: PRE-DEPLOYMENT ==================== -->

  <rect x="30" y="80" width="1040" height="520" rx="8" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1.5"/>
  <text x="50" y="105" font-size="12" font-weight="700" fill="#94a3b8" letter-spacing="1.5">PRE-DEPLOYMENT</text>

  <!-- Step 1: Intent Declaration -->
  <rect x="370" y="120" width="360" height="56" rx="6" fill="#1e40af" stroke="#1e3a8a" stroke-width="1.5"/>
  <text x="550" y="145" text-anchor="middle" font-size="14" font-weight="700" fill="#ffffff">Developer Submits Intent Declaration</text>
  <text x="550" y="163" text-anchor="middle" font-size="11" fill="#bfdbfe">Behaviours Â· Data classification Â· Impact Â· Agentic scope</text>

  <!-- Arrow down to review -->
  <line x1="550" y1="176" x2="550" y2="200" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 2: Governance Review -->
  <rect x="400" y="200" width="300" height="44" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="550" y="220" text-anchor="middle" font-size="13" font-weight="600" fill="#334155">AI Governance Review</text>
  <text x="550" y="236" text-anchor="middle" font-size="11" fill="#64748b">Completeness and accuracy check</text>

  <!-- Decision diamond: Complete? -->
  <polygon points="550,268 620,298 550,328 480,298" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="550" y="302" text-anchor="middle" font-size="11" font-weight="600" fill="#334155">Complete?</text>

  <!-- No â†’ back to declaration -->
  <line x1="480" y1="298" x2="370" y2="298" stroke="#dc2626" stroke-width="1.5" marker-end="url(#arrow-red)"/>
  <path d="M370,298 L370,148 L370,148" stroke="#dc2626" stroke-width="1.5" fill="none" marker-end="url(#arrow-red)"/>
  <text x="410" y="290" font-size="10" font-weight="600" fill="#dc2626">No â€” return for revision</text>

  <!-- Yes â†’ tier determination -->
  <line x1="550" y1="328" x2="550" y2="358" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 3: Tier Determination -->
  <rect x="370" y="358" width="360" height="44" rx="6" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <text x="550" y="378" text-anchor="middle" font-size="13" font-weight="600" fill="#166534">Tier Determined from Declaration</text>
  <text x="550" y="394" text-anchor="middle" font-size="11" fill="#15803d">Automatic â€” owner does not choose</text>

  <!-- Tier outputs -->
  <line x1="550" y1="402" x2="550" y2="420" stroke="#334155" stroke-width="1.5"/>

  <!-- Tier boxes row -->
  <rect x="55" y="420" width="160" height="40" rx="4" fill="#f0fdf4" stroke="#86efac" stroke-width="1"/>
  <text x="135" y="438" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">Low</text>
  <text x="135" y="452" text-anchor="middle" font-size="9" fill="#15803d">Guardrails + logging only</text>

  <rect x="240" y="420" width="160" height="40" rx="4" fill="#eff6ff" stroke="#93c5fd" stroke-width="1"/>
  <text x="320" y="438" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">Medium</text>
  <text x="320" y="452" text-anchor="middle" font-size="9" fill="#2563eb">+ Judge 5â€“10% + batch review</text>

  <rect x="425" y="420" width="160" height="40" rx="4" fill="#fefce8" stroke="#fde047" stroke-width="1"/>
  <text x="505" y="438" text-anchor="middle" font-size="11" font-weight="600" fill="#854d0e">High</text>
  <text x="505" y="452" text-anchor="middle" font-size="9" fill="#a16207">+ Judge 20-50% + HITL SLA</text>

  <rect x="610" y="420" width="160" height="40" rx="4" fill="#fef2f2" stroke="#fca5a5" stroke-width="1"/>
  <text x="690" y="438" text-anchor="middle" font-size="11" font-weight="600" fill="#991b1b">Critical</text>
  <text x="690" y="452" text-anchor="middle" font-size="9" fill="#b91c1c">+ Judge 100% inline + HITL all</text>

  <!-- Connector lines from tier determination to tier boxes -->
  <line x1="550" y1="420" x2="135" y2="420" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="550" y1="420" x2="320" y2="420" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="550" y1="420" x2="505" y2="420" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="550" y1="420" x2="690" y2="420" stroke="#cbd5e1" stroke-width="1"/>

  <!-- Exception box to the right -->
  <rect x="830" y="420" width="200" height="40" rx="4" fill="#ffffff" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="930" y="438" text-anchor="middle" font-size="11" font-weight="600" fill="#64748b">Disagree with tier?</text>
  <text x="930" y="452" text-anchor="middle" font-size="9" fill="#94a3b8">Amend declaration or exception</text>
  <line x1="770" y1="440" x2="830" y2="440" stroke="#94a3b8" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrow)"/>

  <!-- All tiers converge to guardrail derivation -->
  <line x1="135" y1="460" x2="135" y2="485" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="320" y1="460" x2="320" y2="485" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="505" y1="460" x2="505" y2="485" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="690" y1="460" x2="690" y2="485" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="135" y1="485" x2="690" y2="485" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="412" y1="485" x2="412" y2="500" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 4: Guardrail Derivation -->
  <rect x="230" y="500" width="360" height="44" rx="6" fill="#1e40af" stroke="#1e3a8a" stroke-width="1.5"/>
  <text x="410" y="520" text-anchor="middle" font-size="13" font-weight="700" fill="#ffffff">Guardrails Derived from Declaration</text>
  <text x="410" y="536" text-anchor="middle" font-size="11" fill="#bfdbfe">Every guardrail traces to a declaration field</text>

  <!-- Derivation detail callouts -->
  <rect x="640" y="498" width="250" height="48" rx="4" fill="#ffffff" stroke="#93c5fd" stroke-width="1"/>
  <text x="655" y="514" font-size="10" fill="#475569">Out-of-scope â†’ topic blocklists</text>
  <text x="655" y="526" font-size="10" fill="#475569">PII categories â†’ detection rules</text>
  <text x="655" y="538" font-size="10" fill="#475569">Tool inventory â†’ allowlists</text>
  <line x1="590" y1="522" x2="640" y2="522" stroke="#93c5fd" stroke-width="1"/>

  <!-- Arrow to deploy -->
  <line x1="410" y1="544" x2="410" y2="572" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 5: Deploy -->
  <rect x="310" y="572" width="200" height="36" rx="18" fill="#16a34a" stroke="#15803d" stroke-width="1.5"/>
  <text x="410" y="595" text-anchor="middle" font-size="14" font-weight="700" fill="#ffffff">Deploy to Production</text>

  <!-- ==================== PHASE 2: RUNTIME ==================== -->

  <rect x="30" y="630" width="1040" height="860" rx="8" fill="#fffbeb" stroke="#fde68a" stroke-width="1.5"/>
  <text x="50" y="655" font-size="12" font-weight="700" fill="#d97706" letter-spacing="1.5">RUNTIME â€” GUARDRAILS ALWAYS ON</text>

  <!-- Interaction flow -->
  <rect x="370" y="670" width="280" height="40" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="510" y="694" text-anchor="middle" font-size="13" font-weight="600" fill="#334155">AI System Processes Transaction</text>

  <line x1="510" y1="710" x2="510" y2="738" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Guardrail check diamond -->
  <polygon points="510,738 600,778 510,818 420,778" fill="#ffffff" stroke="#d97706" stroke-width="2"/>
  <text x="510" y="774" text-anchor="middle" font-size="12" font-weight="700" fill="#92400e">Guardrail</text>
  <text x="510" y="790" text-anchor="middle" font-size="12" font-weight="700" fill="#92400e">Triggered?</text>

  <!-- NO path â€” clean pass -->
  <line x1="600" y1="778" x2="720" y2="778" stroke="#16a34a" stroke-width="2" marker-end="url(#arrow-green)"/>
  <rect x="720" y="758" width="200" height="40" rx="6" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <text x="820" y="778" text-anchor="middle" font-size="12" font-weight="600" fill="#166534">Clean Pass</text>
  <text x="820" y="792" text-anchor="middle" font-size="10" fill="#15803d">Response delivered. No cost event.</text>
  <text x="660" y="770" font-size="11" font-weight="600" fill="#16a34a">No</text>

  <!-- Routine sampling path from clean pass -->
  <line x1="820" y1="798" x2="820" y2="830" stroke="#2563eb" stroke-width="1.5" marker-end="url(#arrow-blue)"/>
  <rect x="720" y="830" width="200" height="36" rx="4" fill="#eff6ff" stroke="#93c5fd" stroke-width="1"/>
  <text x="820" y="848" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">Routine Judge Sampling</text>
  <text x="820" y="860" text-anchor="middle" font-size="9" fill="#2563eb">Per tier rate Â· Central cost</text>

  <!-- YES path â€” trigger -->
  <line x1="510" y1="818" x2="510" y2="858" stroke="#dc2626" stroke-width="2" marker-end="url(#arrow-red)"/>
  <text x="520" y="840" font-size="11" font-weight="600" fill="#dc2626">Yes</text>

  <!-- Trigger actions box -->
  <rect x="330" y="858" width="360" height="90" rx="6" fill="#fef2f2" stroke="#fca5a5" stroke-width="1.5"/>
  <text x="510" y="880" text-anchor="middle" font-size="13" font-weight="700" fill="#991b1b">Guardrail Trigger</text>
  <text x="350" y="898" font-size="11" fill="#7f1d1d">â‘  Block or flag the interaction</text>
  <text x="350" y="914" font-size="11" fill="#7f1d1d">â‘¡ Log full context</text>
  <text x="350" y="930" font-size="11" fill="#7f1d1d">â‘¢ Record cost event against solution</text>
  <text x="350" y="946" font-size="11" fill="#7f1d1d">â‘£ Increment trigger counter</text>

  <!-- From trigger to rate check -->
  <line x1="510" y1="948" x2="510" y2="978" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Rate threshold diamond -->
  <polygon points="510,978 610,1013 510,1048 410,1013" fill="#ffffff" stroke="#d97706" stroke-width="1.5"/>
  <text x="510" y="1009" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">Rate > 1%</text>
  <text x="510" y="1023" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">threshold?</text>

  <!-- Below threshold â€” logged, weekly review -->
  <line x1="410" y1="1013" x2="260" y2="1013" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="340" y="1005" font-size="10" font-weight="600" fill="#64748b">Below</text>
  <rect x="80" y="993" width="180" height="40" rx="4" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="170" y="1013" text-anchor="middle" font-size="11" font-weight="600" fill="#334155">Logged + Weekly Review</text>
  <text x="170" y="1027" text-anchor="middle" font-size="9" fill="#64748b">Included in governance report</text>

  <!-- Above threshold â€” investigation -->
  <line x1="510" y1="1048" x2="510" y2="1080" stroke="#dc2626" stroke-width="2" marker-end="url(#arrow-red)"/>
  <text x="520" y="1068" font-size="10" font-weight="600" fill="#dc2626">Above</text>

  <!-- Alert + Investigate box -->
  <rect x="350" y="1080" width="320" height="58" rx="6" fill="#fef2f2" stroke="#fca5a5" stroke-width="1.5"/>
  <text x="510" y="1100" text-anchor="middle" font-size="13" font-weight="700" fill="#991b1b">Alert + Investigate</text>
  <text x="510" y="1118" text-anchor="middle" font-size="11" fill="#7f1d1d">Alert system owner + AI governance</text>
  <text x="510" y="1132" text-anchor="middle" font-size="11" fill="#7f1d1d">Root cause investigation required</text>

  <!-- Investigation outcomes -->
  <line x1="510" y1="1138" x2="510" y2="1165" stroke="#334155" stroke-width="1.5"/>

  <!-- Four outcome boxes -->
  <!-- Outcome 1: System Defect -->
  <rect x="55" y="1185" width="210" height="64" rx="5" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="160" y="1205" text-anchor="middle" font-size="12" font-weight="700" fill="#334155">System Defect</text>
  <text x="160" y="1221" text-anchor="middle" font-size="10" fill="#64748b">Model producing undeclared</text>
  <text x="160" y="1233" text-anchor="middle" font-size="10" fill="#64748b">behaviour</text>
  <text x="160" y="1247" text-anchor="middle" font-size="10" font-weight="600" fill="#dc2626">â†’ Fix the system</text>
  <line x1="510" y1="1165" x2="160" y2="1165" stroke="#cbd5e1" stroke-width="1"/>
  <line x1="160" y1="1165" x2="160" y2="1185" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Outcome 2: Declaration Gap -->
  <rect x="290" y="1185" width="210" height="64" rx="5" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="395" y="1205" text-anchor="middle" font-size="12" font-weight="700" fill="#334155">Declaration Gap</text>
  <text x="395" y="1221" text-anchor="middle" font-size="10" fill="#64748b">Legitimate behaviour not</text>
  <text x="395" y="1233" text-anchor="middle" font-size="10" fill="#64748b">declared upfront</text>
  <text x="395" y="1247" text-anchor="middle" font-size="10" font-weight="600" fill="#d97706">â†’ Amend declaration</text>
  <line x1="395" y1="1165" x2="395" y2="1185" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Outcome 3: Guardrail Bug -->
  <rect x="525" y="1185" width="210" height="64" rx="5" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="630" y="1205" text-anchor="middle" font-size="12" font-weight="700" fill="#334155">Guardrail Bug</text>
  <text x="630" y="1221" text-anchor="middle" font-size="10" fill="#64748b">Rule misconfigured vs.</text>
  <text x="630" y="1233" text-anchor="middle" font-size="10" fill="#64748b">declaration</text>
  <text x="630" y="1247" text-anchor="middle" font-size="10" font-weight="600" fill="#2563eb">â†’ Fix the guardrail</text>
  <line x1="630" y1="1165" x2="630" y2="1185" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Outcome 4: External Attack -->
  <rect x="760" y="1185" width="210" height="64" rx="5" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="865" y="1205" text-anchor="middle" font-size="12" font-weight="700" fill="#334155">External Attack</text>
  <text x="865" y="1221" text-anchor="middle" font-size="10" fill="#64748b">Adversary manipulating</text>
  <text x="865" y="1233" text-anchor="middle" font-size="10" fill="#64748b">the system</text>
  <text x="865" y="1247" text-anchor="middle" font-size="10" font-weight="600" fill="#991b1b">â†’ Security incident</text>
  <line x1="865" y1="1165" x2="865" y2="1185" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Cost chargeback bar -->
  <rect x="55" y="1280" width="680" height="40" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="395" y="1298" text-anchor="middle" font-size="12" font-weight="700" fill="#92400e">ðŸ’° Investigation Costs Charged to Solution</text>
  <text x="395" y="1313" text-anchor="middle" font-size="10" fill="#a16207">Judge evaluation + reviewer time + analyst time â†’ monthly chargeback report</text>

  <!-- Exception: attack costs not charged -->
  <rect x="760" y="1280" width="210" height="40" rx="5" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <text x="865" y="1298" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">Not charged to solution</text>
  <text x="865" y="1313" text-anchor="middle" font-size="10" fill="#15803d">Borne by security function</text>

  <!-- Feedback loops -->
  <!-- Declaration amendment feeds back to guardrail derivation -->
  <rect x="55" y="1355" width="1010" height="110" rx="6" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="75" y="1378" font-size="12" font-weight="700" fill="#334155">Feedback Loops</text>

  <text x="75" y="1402" font-size="11" fill="#475569">â‘  Declaration amendments â†’ re-derive guardrails â†’ updated controls deployed</text>
  <text x="75" y="1422" font-size="11" fill="#475569">â‘¡ Attack patterns â†’ strengthen guardrails â†’ better prevention next time</text>
  <text x="75" y="1442" font-size="11" fill="#475569">â‘¢ Monthly chargeback report â†’ incentivises accurate declarations + quality engineering</text>
  <text x="75" y="1462" font-size="11" fill="#475569">â‘£ Quarterly exception + trigger review â†’ adjust defaults if common patterns emerge</text>

  <!-- Footer -->
  <text x="550" y="1505" text-anchor="middle" font-size="11" fill="#94a3b8">AI Security Reference Architecture â€” Default Controls and Exception Governance</text>

</svg>
