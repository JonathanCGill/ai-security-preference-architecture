<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 480" width="700" height="480">
  <rect width="700" height="480" fill="#f8fafc"/>
  
  <text x="350" y="25" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1e293b" text-anchor="middle">Judge as Policy Decision Point (PDP)</text>
  
  <!-- User Request -->
  <rect x="282" y="47" width="140" height="35" rx="6" fill="#374151"/>
  <rect x="280" y="45" width="140" height="35" rx="6" fill="#64748b"/>
  <text x="350" y="68" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">User Request</text>
  
  <!-- Arrow to Gateway -->
  <line x1="350" y1="80" x2="350" y2="105" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="350,110 345,100 355,100" fill="#94a3b8"/>
  
  <!-- Gateway/PEP -->
  <rect x="252" y="117" width="200" height="50" rx="6" fill="#0f2744"/>
  <rect x="250" y="115" width="200" height="50" rx="6" fill="#1e3a5f"/>
  <text x="350" y="140" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Gateway / PEP</text>
  <text x="350" y="155" font-family="Arial, sans-serif" font-size="9" fill="#94a3b8" text-anchor="middle">Enforces Judge decisions</text>
  
  <!-- Arrow to Judge -->
  <line x1="350" y1="165" x2="350" y2="190" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="350,195 345,185 355,185" fill="#94a3b8"/>
  
  <!-- Judge/PDP -->
  <rect x="252" y="202" width="200" height="50" rx="6" fill="#1e40af"/>
  <rect x="250" y="200" width="200" height="50" rx="6" fill="#3b82f6"/>
  <text x="350" y="223" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Judge / PDP</text>
  <text x="350" y="238" font-family="Arial, sans-serif" font-size="9" fill="#dbeafe" text-anchor="middle">Policy Decision Point</text>
  
  <!-- Context/PIP Box -->
  <rect x="502" y="182" width="150" height="90" rx="6" fill="#047857"/>
  <rect x="500" y="180" width="150" height="90" rx="6" fill="#10b981"/>
  <text x="575" y="200" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">Context / PIP</text>
  <text x="575" y="218" font-family="Arial, sans-serif" font-size="8" fill="#d1fae5" text-anchor="middle">User identity</text>
  <text x="575" y="232" font-family="Arial, sans-serif" font-size="8" fill="#d1fae5" text-anchor="middle">Risk tier</text>
  <text x="575" y="246" font-family="Arial, sans-serif" font-size="8" fill="#d1fae5" text-anchor="middle">History</text>
  <text x="575" y="260" font-family="Arial, sans-serif" font-size="8" fill="#d1fae5" text-anchor="middle">Tool permissions</text>
  
  <!-- Arrow from PIP to Judge -->
  <line x1="500" y1="225" x2="455" y2="225" stroke="#10b981" stroke-width="2"/>
  <polygon points="450,225 460,220 460,230" fill="#10b981"/>
  
  <!-- Arrow to Decision -->
  <line x1="350" y1="250" x2="350" y2="285" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="350,290 345,280 355,280" fill="#94a3b8"/>
  
  <!-- Decision diamond shape using rect with rotation simulation -->
  <rect x="307" y="297" width="90" height="35" rx="6" fill="#5b21b6"/>
  <rect x="305" y="295" width="90" height="35" rx="6" fill="#8b5cf6"/>
  <text x="350" y="317" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">Decision</text>
  
  <!-- Three branches: ALLOW, BLOCK, REVIEW -->
  <!-- ALLOW branch -->
  <line x1="305" y1="312" x2="180" y2="312" stroke="#94a3b8" stroke-width="2"/>
  <line x1="180" y1="312" x2="180" y2="365" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="180,370 175,360 185,360" fill="#94a3b8"/>
  
  <rect x="112" y="377" width="140" height="40" rx="6" fill="#047857"/>
  <rect x="110" y="375" width="140" height="40" rx="6" fill="#10b981"/>
  <text x="180" y="393" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">ALLOW</text>
  <text x="180" y="406" font-family="Arial, sans-serif" font-size="8" fill="#d1fae5" text-anchor="middle">Forward to Model</text>
  
  <!-- BLOCK branch -->
  <line x1="350" y1="330" x2="350" y2="365" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="350,370 345,360 355,360" fill="#94a3b8"/>
  
  <rect x="282" y="377" width="140" height="40" rx="6" fill="#b91c1c"/>
  <rect x="280" y="375" width="140" height="40" rx="6" fill="#ef4444"/>
  <text x="350" y="393" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">BLOCK</text>
  <text x="350" y="406" font-family="Arial, sans-serif" font-size="8" fill="#fecaca" text-anchor="middle">Return Refusal</text>
  
  <!-- REVIEW branch -->
  <line x1="395" y1="312" x2="520" y2="312" stroke="#94a3b8" stroke-width="2"/>
  <line x1="520" y1="312" x2="520" y2="365" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="520,370 515,360 525,360" fill="#94a3b8"/>
  
  <rect x="452" y="377" width="140" height="40" rx="6" fill="#b45309"/>
  <rect x="450" y="375" width="140" height="40" rx="6" fill="#f59e0b"/>
  <text x="520" y="393" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">REVIEW</text>
  <text x="520" y="406" font-family="Arial, sans-serif" font-size="8" fill="#fef3c7" text-anchor="middle">Human Queue</text>
  
  <!-- Labels -->
  <text x="140" y="345" font-family="Arial, sans-serif" font-size="9" fill="#10b981">Safe</text>
  <text x="355" y="350" font-family="Arial, sans-serif" font-size="9" fill="#ef4444">Attack</text>
  <text x="530" y="345" font-family="Arial, sans-serif" font-size="9" fill="#f59e0b">Uncertain</text>
  
  <!-- Footer -->
  <rect x="50" y="435" width="600" height="35" rx="4" fill="#f1f5f9"/>
  <text x="350" y="455" font-family="Arial, sans-serif" font-size="9" fill="#475569" text-anchor="middle">PDP = Policy Decision Point | PEP = Policy Enforcement Point | PIP = Policy Information Point</text>
</svg>
